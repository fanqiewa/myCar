<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>产品细节</title>
    <link rel="stylesheet" href="./layui/css/layui.css">
    <link rel="stylesheet" href="./css/back_base.css">
    <style>
        .layui-upload-img {
            width: 110px;
            height: 92px;
            margin: 0 10px 10px 0;
        }
    </style>
</head>
<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">
    <div class="layui-header">
        <div class="layui-logo">
            <img src="../img/logo.png" alt="" style="width: 80%;height: 100%">
        </div>
        <!-- 头部区域（可配合layui已有的水平导航） -->
        <ul class="layui-nav layui-layout-left">
            <li class="layui-nav-item"><a href="">控制台</a></li>
            <li class="layui-nav-item"><a href="">商品管理</a></li>
            <li class="layui-nav-item">
                <a href="javascript:;">其它系统</a>
                <dl class="layui-nav-child">
                    <dd><a href="">邮件管理</a></dd>
                    <dd><a href="">消息管理</a></dd>
                    <dd><a href="">授权管理</a></dd>
                </dl>
            </li>
        </ul>
        <ul class="layui-nav layui-layout-right">
            <li class="layui-nav-item">
                <a href="javascript:;">
                    <img src="./img/1.jpg" class="layui-nav-img">
                    陈忠泽
                </a>
                <dl class="layui-nav-child">
                    <dd><a href="">基本资料</a></dd>
                    <dd><a href="">安全设置</a></dd>
                </dl>
            </li>
            <li class="layui-nav-item"><a href="./login.html">注销</a></li>
        </ul>
    </div>

    <div class="layui-side layui-bg-black">
        <div class="layui-side-scroll">
            <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
            <ul class="layui-nav layui-nav-tree"  lay-filter="test">
                <li class="layui-nav-item layui-nav-itemed">
                    <a class="" href="javascript:;">产品管理</a>
                    <dl class="layui-nav-child">
                        <dd><a href="back_productList.html">产品列表</a></dd>
                        <dd><a href="back_addProduct.html">产品添加</a></dd>
                        <dd class="layui-this"><a href="back_addFDT.html">外饰添加</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item">
                    <a href="javascript:;">新闻管理</a>
                    <dl class="layui-nav-child">
                        <dd><a href="./back_newsList.html">新闻列表</a></dd>
                        <dd><a href="./back_addNews.html">新闻添加</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item"><a href="">云市场</a></li>
                <li class="layui-nav-item"><a href="">发布商品</a></li>
            </ul>
        </div>
    </div>

    <div class="layui-body box_content">
        <div style="padding: 15px;">
            <fieldset class="layui-elem-field">
                <legend>请选择要为哪个产品添加外饰</legend>
                <div class="layui-field-box">
                <div style="padding: 20px">
                    <div class="layui-form">
                        <div class="layui-form-item">
                            <label class="layui-form-label">产品类别</label>
                            <div class="layui-input-block">
                                <select name="city" lay-verify="required" id="select1">
                                    <!--<option value="0">北京</option>-->
                                    <!--<option value="1">上海</option>-->
                                    <!--<option value="2">广州</option>-->
                                    <!--<option value="3">深圳</option>-->
                                    <!--<option value="4">杭州</option>-->
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="layui-form">
                        <div class="layui-form-item">
                            <label class="layui-form-label">产品型号</label>
                            <div class="layui-input-block">
                                <select name="city" lay-verify="required" id="select2">
                                    <!--<option value="0">北京</option>-->
                                    <!--<option value="1">上海</option>-->
                                    <!--<option value="2">广州</option>-->
                                    <!--<option value="3">深圳</option>-->
                                    <!--<option value="4">杭州</option>-->
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                </div>
            </fieldset>
            <!--1-->
            <fieldset class="layui-elem-field">
                <legend>产品外观的添加</legend>
                <div style="padding: 20px;">
                    <div class="layui-form-item">
                        <label class="layui-form-label">外观名称</label>
                        <div class="layui-input-block">
                            <input type="text" name="username"  placeholder="外观名称" autocomplete="off" class="layui-input" id="facade_title">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">外观图片</label>
                        <img class="layui-upload-img" id="demo1">
                        <button type="button" class="layui-btn" id="test1" onclick="selectFileFacade()"><i class="layui-icon">&#xe67c;</i>上传图片</button>
                        <input type="file" name="facade_image" id="facade_image" style="display:none" onchange="changepicFacade(this)" accept="image/gif,image/jpeg,image/jpg,image/png,image/svg">
                    </div>
                    <div class="layui-form-item layui-form-text">
                        <label class="layui-form-label">外观介绍</label>
                        <div class="layui-input-block">
                            <textarea placeholder="请输入内容" class="layui-textarea" id="editorFacade"></textarea>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn" onclick="sumbitFacade()" >立即提交</button>
                            <button type="reset" class="layui-btn layui-btn-primary" onclick="resetFacade()">重置</button>
                        </div>
                    </div>
                </div>
            </fieldset>
            <!--2-->
            <fieldset class="layui-elem-field">
                <legend>产品内饰的添加</legend>
                <div style="padding: 20px;">
                    <div class="layui-form-item">
                        <label class="layui-form-label">内饰名称</label>
                        <div class="layui-input-block">
                            <input type="text" name="username"  placeholder="内饰名称" autocomplete="off" class="layui-input" id="decorate_title">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">内饰图片</label>
                        <img class="layui-upload-img" id="demo2">
                        <button type="button" class="layui-btn" id="test2" onclick="selectFileDecorate()"><i class="layui-icon">&#xe67c;</i>上传图片</button>
                        <input type="file" name="decorate_image" id="decorate_image" style="display:none" onchange="changepicDecorate(this)" accept="image/gif,image/jpeg,image/jpg,image/png,image/svg">
                    </div>
                    <div class="layui-form-item layui-form-text">
                        <label class="layui-form-label">内饰介绍</label>
                        <div class="layui-input-block">
                            <textarea placeholder="请输入内容" class="layui-textarea" id="editorDecorate"></textarea>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn" onclick="sumbitDecorate()" >立即提交</button>
                            <button type="reset" class="layui-btn layui-btn-primary" onclick="resetDecorate()">重置</button>
                        </div>
                    </div>
                </div>
            </fieldset>
            <!--3-->
            <fieldset class="layui-elem-field">
                <legend>产品科技的添加</legend>
                <div style="padding: 20px;">
                    <div class="layui-form-item">
                        <label class="layui-form-label">内饰名称</label>
                        <div class="layui-input-block">
                            <input type="text" name="username"  placeholder="内饰名称" autocomplete="off" class="layui-input" id="technology_title">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">内饰图片</label>
                        <img class="layui-upload-img" id="demo3">
                        <button type="button" class="layui-btn" id="test3" onclick="selectFileTechnology()"><i class="layui-icon">&#xe67c;</i>上传图片</button>
                        <input type="file" name="technology_image" id="technology_image" style="display:none" onchange="changepicTechnology(this)" accept="image/gif,image/jpeg,image/jpg,image/png,image/svg">
                    </div>
                    <div class="layui-form-item layui-form-text">
                        <label class="layui-form-label">内饰介绍</label>
                        <div class="layui-input-block">
                            <textarea placeholder="请输入内容" class="layui-textarea" id="editorTechnology"></textarea>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn" onclick="sumbitTechnology()" >立即提交</button>
                            <button type="reset" class="layui-btn layui-btn-primary" onclick="resetTechnology()">重置</button>
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="layui-footer" style="text-align: center">
        <!-- 底部固定区域 -->
        Copyright © 2014.Company name All rights reserved.
    </div>
</div>

<script src="./layui/jquery.min.js"></script>
<script src="./layui/layui.all.js"></script>
<script>
    //请求类别：
    layui.use(['form'],function () {
        var layer = layui.layer;
        var form = layui.form;
        function queryCategory() {
            $.ajax({
                type: "get",
                url: "/api/queryAllCategory",
                success : function (data) {
                    if(JSON.parse(data).msg == "Fail") {
                        window.location.href = "login.html"
                    }
                    renderSelect(JSON.parse(data).data)
                },
                error : function (error) {
                    console.log(error)
                }
            });
            function renderSelect(data) {
                var str = "";
                var len = data.length;
                for(var i = 0; i < len; i ++) {
                    str += "<option value=\""+ data[i].id +"\">" + data[i].category_name + "</option>"
                }
                $("#select1").append(str);
                form.render();
            }
        }
        queryCategory();

        function queryVersion() {
            $.ajax({
                type: "get",
                url: "/queryAllVersion",
                success : function (data) {
                    renderSelect(JSON.parse(data).data)
                },
                error : function (error) {
                    console.log(error)
                }
            });
            function renderSelect(data) {
                var str = "";
                var len = data.length;
                for(var i = 0; i < len; i ++) {
                    str += "<option value=\""+ data[i].id +"\">" + data[i].product_version + "</option>"
                }
                $("#select2").append(str);
                form.render();
            }
        }
        queryVersion()
    })

</script>
<!--1-->
<script>
    function selectFileFacade() {
        $("#facade_image").trigger("click");
    }
    function changepicFacade() {
        var reads= new FileReader();
        f=document.getElementById('facade_image').files[0];
        reads.readAsDataURL(f);
        reads.onload=function (e) {
            document.getElementById('demo1').src=this.result;
        };
    }
    function sumbitFacade() {
        var category_name = $("#select1 option:selected").text();
        var product_version = $("#select2 option:selected").text();
        var facade_title = $("#facade_title").val();
        var facade_image = document.getElementById("facade_image").files[0];
        var content = $("#editorFacade").val();
        var form = new FormData();
        var imageType = /^image\//;
        if(facade_title == "" || content == "") {
            alert("facade_title or 内容不能为空！");
            return;
        }
        if(facade_image == undefined) {
            alert("请添加图片！");
            return;
        }
        if(!imageType.test(facade_image.type)) {//判断是否为图片
            alert("请选择图片类型文件！！！")
            return;
        }
        form.append("facade_image",facade_image);
        form.append("content",content);
        $.ajax({
            url:"/addFacade?category_name=" + category_name + "&product_version=" + product_version + "&facade_title=" + facade_title,
            type:"POST",
            data:form,
            processData:false,
            contentType: false,
            success:function (resp) {
                if(JSON.parse(resp).msg == "该车型不存在，请重新选择") {
                    layer.msg(JSON.parse(resp).msg, {icon: 5});
                } else if(JSON.parse(resp).msg == "添加成功") {
                    layer.msg("添加成功！", {icon: 1});
                }
                $("#facade_title").val("");
                $("#editorFacade").val("");
            },
            error:function (resp) {
                console.log(resp)
            }
        })

    }
    function resetFacade() {
        layer.msg("重置成功！");
        $("#facade_title").val("");
        $("#editorFacade").val("");
    }
</script>
<script>
    function selectFileTechnology() {
        $("#technology_image").trigger("click");
    }
    function changepicTechnology() {
        var reads= new FileReader();
        f=document.getElementById('technology_image').files[0];
        reads.readAsDataURL(f);
        reads.onload=function (e) {
            document.getElementById('demo3').src=this.result;
        };
    }
    function sumbitTechnology() {
        var category_name = $("#select1 option:selected").text();
        var product_version = $("#select2 option:selected").text();
        var technology_title = $("#technology_title").val();
        var technology_image = document.getElementById("technology_image").files[0];
        var content = $("#editorTechnology").val();
        var form = new FormData();
        var imageType = /^image\//;
        if(technology_title == "" || content == "") {
            alert("technology_title or 内容不能为空！");
            return;
        }
        if(technology_image == undefined) {
            alert("请添加图片！");
            return;
        }
        if(!imageType.test(technology_image.type)) {//判断是否为图片
            alert("请选择图片类型文件！！！")
            return;
        }
        form.append("technology_image",technology_image);
        form.append("content",content);
        $.ajax({
            url:"/addTechnology?category_name=" + category_name + "&product_version=" + product_version + "&technology_title=" + technology_title,
            type:"POST",
            data:form,
            processData:false,
            contentType: false,
            success:function (resp) {
                if(JSON.parse(resp).msg == "该车型不存在，请重新选择") {
                    layer.msg(JSON.parse(resp).msg, {icon: 5});
                } else if(JSON.parse(resp).msg == "添加成功") {
                    layer.msg("添加成功！", {icon: 1});
                }
                $("#technology_title").val("");
                $("#editorTechnology").val("");
            },
            error:function (resp) {
                console.log(resp)
            }
        })

    }
    function resetTechnology() {
        layer.msg("重置成功！");
        $("#technology_title").val("");
        $("#editorTechnology").val("");
    }
</script>
</body>
</html>
